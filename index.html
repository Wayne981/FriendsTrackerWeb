<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friends Energy Tracker - Track Your Social Vibes</title>
    <meta name="description" content="Track and analyze your energy levels with friends. Discover who brings positive vibes and who might be draining your energy.">
    <meta name="keywords" content="friends tracker, energy levels, social relationships, mood tracker">
    <meta name="author" content="Energy Tracker">
    
    <!-- Open Graph for social sharing -->
    <meta property="og:title" content="Friends Energy Tracker">
    <meta property="og:description" content="Track your vibes with friends and discover your best relationships">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourwebsite.com">

    <!-- Font -->
     <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet"> -->
      <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>😊</text></svg>">

    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- <script src="config.js"></script> -->

    <script>
        // Inline config instead of external file
        window.APP_CONFIG = {

            SUPABASE_URL: 'https://rjpoebykjhmphxsczddt.supabase.co', // Replace with your Supabase URL
            SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJqcG9lYnlramhtcGh4c2N6ZGR0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5NDk5NTMsImV4cCI6MjA3MTUyNTk1M30.rYjqg7NNXToqLQLeNjJxOklXGpJC_y0nxQg5SptA2EQ' // Replace with your Supabase anon key
        };
    </script>

<!-- whatever includes in styles it is CSS -->
 <!-- allowed for copy and paste only this part  -->


<style>

html { scroll-behavior: smooth; }

/* Top Nav */
.top-nav {
  position: sticky;
  top: 0;
  z-index: 200; /* above header (which is z-index:100) */
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  padding: 12px 20px;
  background: linear-gradient(135deg, rgba(255,255,255,0.75), rgba(244,246,246,0.45));
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(177,189,195,0.35);
  box-shadow: 0 8px 24px rgba(172,185,191,0.12);
}

.brand {
  font-weight: 800;
  letter-spacing: -0.02em;
  color: #000;
}


/* Logo link styling */
.brand a {
  text-decoration: none;
  color: inherit;
  display: block;
}

.brand a:hover {
  opacity: 0.8;
  transition: opacity 0.2s ease;
}

/* Navbar Logo */
.logo-text {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
               Ubuntu, Cantarell, "Helvetica Neue", Arial, sans-serif !important;
  font-size: 28px;
  font-weight: 700;
  letter-spacing: -0.6px;
  line-height: 1;
  display: inline-block;
  position: relative;
  color: #000;
}

.logo-text::after {
  content: "";
  position: absolute;
  bottom: -6px;
  left: 0;
  width: 24px;
  height: 3px;
  background: #000;
  border-radius: 2px;
}

.nav-links {
  display: flex;
  align-items: center;
  gap: 18px;
  flex-wrap: wrap;
}

.nav-link {
  text-decoration: none;
  color: rgba(0,0,0,0.8);
  font-weight: 600;
  padding: 8px 12px;
  border-radius: 12px;
  transition: transform .2s ease, background .2s ease;
font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
}

.nav-link:hover {
  background: rgba(255,255,255,0.6);
  transform: translateY(-1px);
}

.nav-right {
  display: flex;
  align-items: center;
  gap: 12px;
}

/* Re-scope user-info to sit nicely inside the nav (override the fixed pos) */
.top-nav .user-info {
  position: static;
  display: none;      /* stays hidden until .visible is added by your JS */
  background: rgba(255,255,255,0.6);
  padding: 8px 14px;
}

@media (max-width: 768px) {
  .nav-links { gap: 10px; }
  .brand { font-size: 14px; }
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    background: linear-gradient(135deg, #f4f6f6 0%, #b1bdc3 50%, #acb9bf 100%);
    min-height: 100vh;
    color: #000000;
    overflow-x: hidden;
    position: relative;
}

/* Enhanced background with floating orbs */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.12) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(172, 185, 191, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(244, 246, 246, 0.1) 0%, transparent 50%);
    animation: etherealDrift 20s ease-in-out infinite alternate;
    pointer-events: none;
    z-index: -1;
}

@keyframes etherealDrift {
    0% { transform: translate(-30px, -30px) rotate(0deg) scale(1); }
    100% { transform: translate(30px, 30px) rotate(3deg) scale(1.1); }
}

/* Auth Modal */
.auth-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.auth-form {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(177, 189, 195, 0.6);
    border-radius: 28px;
    padding: 40px;
    max-width: 400px;
    width: 90%;
    text-align: center;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.auth-form h2 {
    font-size: 28px;
    font-weight: 800;
    color: #000000;
    margin-bottom: 16px;
    /* font-family: 'Times New Roman', Times, serif; */
}

.auth-subtitle {
    font-size: 16px;
    color: rgba(0, 0, 0, 0.7);
    margin-bottom: 32px;
    line-height: 1.5;
    /* font-family: 'Times New Roman', Times, serif; */
}

.google-btn {
    width: 100%;
    padding: 18px 24px;
    background: #fff;
    color: #333;
    border: 2px solid #ddd;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    /* font-family: 'Times New Roman', Times, serif; */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 24px;
}

.google-btn:hover {
    background: #f8f9fa;
    border-color: #ccc;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.google-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.google-icon {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

.auth-features {
    background: rgba(255, 255, 255, 0.7);
    border-radius: 16px;
    padding: 20px;
    margin-top: 24px;
}

.auth-features h3 {
    font-size: 16px;
    font-weight: 700;
    color: #000000;
    margin-bottom: 12px;
    /* font-family: 'Times New Roman', Times, serif; */
}

.auth-features ul {
    list-style: none;
    padding: 0;
    margin: 0;
    text-align: left;
}

.auth-features li {
    font-size: 14px;
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 8px;
    padding-left: 20px;
    position: relative;
    /* font-family: 'Times New Roman', Times, serif; */
}

.auth-features li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: #4285F4;
    font-weight: bold;
}

.error-message {
    color: #ff4757;
    font-size: 14px;
    margin-top: 10px;
    padding: 10px;
    background: rgba(255, 71, 87, 0.1);
    border-radius: 8px;
}

/* Website container - wider for desktop */
.website-container {
    max-width: 1200px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.4);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(177, 189, 195, 0.5);
    min-height: 100vh;
    position: relative;
    box-shadow: 
        0 20px 60px rgba(172, 185, 191, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
}

/* User Info */
.user-info {
    display: none; /* Hidden by default */
    position: fixed;          /* stays pinned to top-right */
    top: 20px;
    right: 20px;
    align-items: center;
    gap: 16px;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(16px);
    padding: 12px 20px;
    border-radius: 50px;
    font-size: 14px;
    color: #000000;
    z-index: 200;             /* ensures it's above the header */
    box-shadow: 0 4px 12px rgba(0,0,0,0.1); /* optional polish */
}

/* When user info should be visible */
.user-info.visible {
    display: flex;
}

.logout-btn {
    background: linear-gradient(135deg, #ff4757, #ff3838);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
    /* font-family: 'Times New Roman', Times, serif; */
}

/* Website Header */
.website-header {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(244, 246, 246, 0.3));
    backdrop-filter: blur(32px);
    border-bottom: 1px solid rgba(177, 189, 195, 0.3);
    color: #000000;
    padding: 60px 40px 40px;
    text-align: center;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 8px 40px rgba(172, 185, 191, 0.08);
}

.website-header h1 {
    font-size: 48px;
    font-weight: 800;
    margin-bottom: 16px;
    color: #000000;
    letter-spacing: -0.03em;
    text-shadow: 0 4px 20px rgba(172, 185, 191, 0.2);
}

.website-header .subtitle {
    font-size: 24px;
    opacity: 0.85;
    font-weight: 500;
    color: #000000;
    letter-spacing: 0.02em;
    margin-bottom: 12px;
}

.website-header .description {
    font-size: 18px;
    opacity: 0.7;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
}

/* Main content area */
.main-content {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 40px;
    padding: 40px;
    align-items: start;
}

/* Tracker section */
.tracker-section {
    position: sticky;
    top: 200px;
}

.add-friend {
    background: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(177, 189, 195, 0.6);
    border-radius: 28px;
    padding: 32px 28px;
    margin-bottom: 32px;
    box-shadow: 
        0 20px 50px rgba(172, 185, 191, 0.08),
        0 0 0 1px rgba(255, 255, 255, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.7);
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
}

.friend-input {
    width: 100%;
    padding: 20px 24px;
    border: 2px solid rgba(177, 189, 195, 0.4);
    border-radius: 20px;
    font-size: 17px;
    font-weight: 500;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(16px);
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    color: #000000;
    box-shadow: inset 0 2px 4px rgba(172, 185, 191, 0.06);
    /* font-family: 'Times New Roman', Times, serif; */
    margin-bottom: 20px;
}

.friend-input:focus {
    outline: none;
    border-color: rgba(172, 185, 191, 0.4);
    background: rgba(255, 255, 255, 0.8);
    transform: scale(1.02);
    box-shadow: 
        0 0 0 4px rgba(177, 189, 195, 0.2),
        0 20px 40px rgba(172, 185, 191, 0.1),
        inset 0 2px 4px rgba(172, 185, 191, 0.06);
}

.energy-selector {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 12px;
    margin-bottom: 24px;
}

.energy-btn {
    aspect-ratio: 1;
    border: 2px solid rgba(179, 179, 179, 0.4);
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(16px);
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
}

.energy-btn:hover:not(.selected) {
    transform: scale(1.05);
    border-color: rgba(43, 43, 43, 0.3);
}

.energy-btn.selected {
    color: #FFFFFF;
    border-color: transparent;
    transform: scale(1.1);
    box-shadow: 0 20px 50px var(--energy-shadow);
}

.energy-btn:nth-child(1) {
    --energy-shadow: rgba(172, 185, 191, 0.4);
    background: linear-gradient(135deg, #acb9bf 0%, #b1bdc3 100%);
}

.energy-btn:nth-child(2) {
    --energy-shadow: rgba(177, 189, 195, 0.4);
    background: linear-gradient(135deg, #b1bdc3 0%, #f4f6f6 100%);
}

.energy-btn:nth-child(3) {
    --energy-shadow: rgba(244, 246, 246, 0.4);
    background: linear-gradient(135deg, #f4f6f6 0%, #ffffff 100%);
}

.energy-btn:nth-child(4) {
    --energy-shadow: rgba(255, 255, 255, 0.4);
    background: linear-gradient(135deg, #ffffff 0%, #f4f6f6 100%);
}

.energy-btn:nth-child(5) {
    --energy-shadow: rgba(172, 185, 191, 0.4);
    background: linear-gradient(135deg, #acb9bf 0%, #ffffff 100%);
}

.energy-btn.selected {
    background: var(--selected-bg) !important;
}

.energy-btn:nth-child(1).selected {
    --selected-bg: linear-gradient(135deg, #acb9bf 0%, #b1bdc3 100%);
}

.energy-btn:nth-child(2).selected {
    --selected-bg: linear-gradient(135deg, #b1bdc3 0%, #f4f6f6 100%);
}

.energy-btn:nth-child(3).selected {
    --selected-bg: linear-gradient(135deg, #f4f6f6 0%, #ffffff 100%);
}

.energy-btn:nth-child(4).selected {
    --selected-bg: linear-gradient(135deg, #ffffff 0%, #f4f6f6 100%);
}

.energy-btn:nth-child(5).selected {
    --selected-bg: linear-gradient(135deg, #acb9bf 0%, #ffffff 100%);
}

.add-btn {
    width: 100%;
    padding: 22px 28px;
    background: linear-gradient(135deg, #acb9bf 0%, #b1bdc3 100%);
    color: #ffffff;
    border: none;
    border-radius: 20px;
    font-size: 17px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    /* font-family: 'Times New Roman', Times, serif; */
}

.add-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 24px 60px rgba(172, 185, 191, 0.4);
}

.add-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

/* Results section */
.results-section {
    min-height: 500px;
}

.analysis-section {
    background: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(177, 189, 195, 0.6);
    border-radius: 28px;
    padding: 32px 28px;
    margin-bottom: 32px;
    box-shadow: 
        0 20px 50px rgba(172, 185, 191, 0.08),
        0 0 0 1px rgba(255, 255, 255, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.7);
}

h1, h2, h3, h4, h5, h6 {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

.analysis-title {
    font-size: 24px;
    font-weight: 500;
    color: #000000;
    margin-bottom: 16px;
    text-align: center;
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif

}

.analysis-content {
    font-size: 16px;
    color: #000000;
    line-height: 1.6;
    text-align: center;
    /* font-family: 'Times New Roman', Times, serif; */
}

.friends-list {
    display: grid;
    gap: 24px;
}

.friend-card {
    background: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(212, 212, 212, 0.6);
    border-radius: 28px;
    padding: 32px 28px;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    box-shadow: 
        0 20px 50px rgba(43, 43, 43, 0.08),
        0 0 0 1px rgba(255, 255, 255, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.7);
}

.friend-card:hover {
    transform: translateY(-8px);
    box-shadow: 
        0 32px 80px rgba(43, 43, 43, 0.15),
        0 0 0 1px rgba(255, 255, 255, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
}

.friend-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
}

.friend-name {
    font-size: 24px;
    font-weight: 400;
    color: #000000;
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
}

.hangout-count {
    background: linear-gradient(135deg, #2B2B2B, #B3B3B3);
    color: #FFFFFF;
    padding: 12px 20px;
    border-radius: 50px;
    font-size: 14px;
    font-weight: 700;
    /* font-family: 'Times New Roman', Times, serif; */
}

.delete-btn {
    background: linear-gradient(135deg, #ff4757, #ff3838);
    color: white;
    border: none;
    border-radius: 12px;
    padding: 8px 16px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-left: 12px;
    /* font-family: 'Times New Roman', Times, serif; */
}

.delete-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 24px rgba(255, 71, 87, 0.3);
}

.energy-history {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
    flex-wrap: wrap;
}

.energy-dot {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    cursor: pointer;
    border: 3px solid rgba(177, 189, 195, 0.3);
    color: #ffffff;
}

.energy-dot:hover {
    transform: scale(1.2);
    z-index: 10;
}

.energy-average {
    text-align: center;
    font-size: 18px;
    font-weight: 500;
    padding: 20px 24px;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(16px);
    border: 1px solid rgba(177, 189, 195, 0.4);
    color: #000000;
    /* font-family: 'Times New Roman', Times, serif; */
}

.energy-1 { background: linear-gradient(135deg, #acb9bf 0%, #b1bdc3 100%); }
.energy-2 { background: linear-gradient(135deg, #b1bdc3 0%, #f4f6f6 100%); }
.energy-3 { background: linear-gradient(135deg, #f4f6f6 0%, #ffffff 100%); }
.energy-4 { background: linear-gradient(135deg, #ffffff 0%, #f4f6f6 100%); }
.energy-5 { background: linear-gradient(135deg, #acb9bf 0%, #ffffff 100%); }

.empty-state {
    text-align: center;
    padding: 80px 24px;
    color: rgba(0, 0, 0, 0.8);
}

.empty-state h3 {
    font-size: 28px;
    font-weight: 800;
    margin-bottom: 16px;
    color: #000000;
}

.empty-state p {
    font-size: 18px;
    color: rgba(0, 0, 0, 0.7);
    line-height: 1.7;
}

/* Website Footer */
.website-footer {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(244, 246, 246, 0.3));
    backdrop-filter: blur(32px);
    border-top: 1px solid rgba(177, 189, 195, 0.3);
    padding: 40px;
    text-align: center;
    color: rgba(0, 0, 0, 0.7);
    margin-top: 60px;
}

.stats-display {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(24px);
    border: 1px solid rgba(177, 189, 195, 0.4);
    padding: 20px 32px;
    border-radius: 50px;
    color: #000000;
    font-weight: 700;
    /* font-family: 'Times New Roman', Times, serif; */
    display: inline-block;
    margin-top: 20px;
    text-align: center;
}

/* Celebration effect */
@keyframes celebrate {
    0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
    50% { transform: translate(-50%, -50%) scale(2.5) rotate(180deg); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(0) rotate(360deg); opacity: 0; }
}

.celebration {
    position: fixed;
    font-size: 80px;
    z-index: 1000;
    pointer-events: none;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    animation: celebrate 2s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}

.hidden { display: none; }

/* Responsive Design */
@media (max-width: 1024px) {
    .main-content {
        grid-template-columns: 1fr;
        gap: 30px;
    }
    
    .tracker-section {
        position: relative;
        top: 0;
    }
}

@media (max-width: 768px) {
    .website-container {
        margin: 0;
        border-radius: 0;
    }
    
    .website-header {
        padding: 40px 20px 30px;
    }
    
    .website-header h1 {
        font-size: 36px;
    }
    
    .website-header .subtitle {
        font-size: 20px;
    }
    
    .main-content {
        padding: 30px 20px;
    }
    
    .user-info {
        position: relative;
        top: auto;
        right: auto;
        margin-bottom: 20px;
        justify-content: center;
    }
    
    .add-friend,
    .friend-card,
    .analysis-section {
        padding: 24px 20px;
        border-radius: 20px;
    }
}

</style>


    </head>

<!-- all things inside visible content of your webpage -->
    <body>
        <!-- Authentication modal  -->
         <div id="authModal" class="auth-modal">
            <div class="auth-form">
                <h2>Welcome to Friends Energy Tracker</h2>
                <p class="auth-subtitle">Track your social vibes and discover which friends bring you the most positive energy</p>

                <div id="authError" class="error-message hidden"></div>

<!-- Google Sign In Button -->
 <button id="googleSignIn" class="google-btn">
    <svg class="google-icon" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
<span id="googleBtnText">Sign in with Google</span>
 </button>

 <div class="auth-features">
    <h3>🌟 What you'll get:</h3>
    <ul>
        <li>Track energy levels with friends</li>
                    <li>Get personalized friendship insights</li>
                    <li>Sync across all your devices</li>
                    <li>Secure & private data storage</li>
    </ul>
 </div>
 <!-- Welcomes users to the application

Explains the app's purpose

Provides a Google sign-in option with the recognizable Google logo

Lists benefits of using the application to encourage sign-ups

Includes an error message area for authentication feedback -->

            </div>
         </div>
    <div class="website-container">
        <!-- User Info
         <div class="user-info">
            <div style="display: flex; align-items: center; gap: 12px;">
                <img id="userAvatar" src="" alt="User" style="width: 32px; height: 32px; border-radius: 50%; display: none;">
                <span id="userEmail"></span>
            </div>
            <button class="logout-btn">Logout</button>
         </div> -->

<!-- New sticky Navbar -->
 <nav class="top-nav">
    <div class="brand">
  <a href="index.html">
    <div class="logo-text">yril</div>
  </a>
</div>

    <div class="nav-links">
        <!-- link to the about page -->
        <a href="about.html" class="nav-link">About</a>
        <a href="#about" class="nav-link">Pricing</a> 
    </div>

    <div class="nav-right">
        <!-- moved user-info into the nav -->
         <div class="user-info">
            <div style="display: flex; align-items: center; gap: 12px;">
                <img id="userAvatar" src="" alt="User" style="width:32px; border-radius: 50%; display: none;">
                <span id="userEmail"></span>
            </div>
            <button class="logout-btn">Logout</button>
         </div>
    </div>
 </nav>



        <!-- Enhanced Website Header -->
        <header class="website-header">
            <h1>Friends Energy Tracker</h1>
            <p class="subtitle">Track Your Social Vibes</p>
            <p class="description">Discover which friends bring you positive energy and which ones might be draining your vibe. Build better relationships with data-driven insights.</p>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Tracker Section -->
            <div class="tracker-section">
                <div class="add-friend">
                    <h2 style="font-size: 20px; font-weight: 800; color: #000000; margin-bottom: 20px; font-family: 'Times New Roman', Times, serif;">Log a Hangout</h2>
                    
                    <input type="text" id="friendName" class="friend-input" placeholder="Friend's name" maxlength="20">

                    <div class="energy-selector" id="energySelector">
                        <div class="energy-btn" data-energy="1" title="Drained">😤</div>
                        <div class="energy-btn" data-energy="2" title="Low">😕</div>
                        <div class="energy-btn" data-energy="3" title="Neutral">🙂</div>
                        <div class="energy-btn" data-energy="4" title="Good">😇</div>
                        <div class="energy-btn" data-energy="5" title="Energized">😁</div>
                    </div>
                    
                    <button class="add-btn" id="addButton">Add Hangout</button>
                </div>

                <div class="stats-display" id="statsDisplay">
                    📊 Total hangouts: <span id="totalHangouts">0</span>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <!-- Analysis Sections -->
                <div id="bestFriendAnalysis" class="analysis-section hidden">
                    <div class="analysis-title">🎯 Who Should You Hangout With Most?</div>
                    <div class="analysis-content" id="bestFriendContent"></div>
                </div>

                <div id="dangerAnalysis" class="analysis-section hidden">
                    <div class="analysis-title">⚠️ Who Might Be Draining Your Energy</div>
                    <div class="analysis-content" id="dangerContent"></div>
                </div>

                <!-- Friends List -->
                <div id="friendsList" class="friends-list">
                    <div class="empty-state">
                        <h3>No friends tracked yet!</h3>
                        <p>Add your first hangout above to start analyzing your social energy patterns</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- About section
         <section id="about" class="analysis-section" style="margin: 0 40px;">
            <div class="analysis-title">About</div>
            <div class="analysis-content">
                Friends Energy Tracker helps you log hangouts and see which relationships boost your vibe.
                Your data is synced securely via Supabase and stays private to your account.
            </div>
         </section> -->

         <!-- Pricing section
          <section id="pricing" class="analysis-section" style="margin: 40px";>
            <div class="analysis-title">Pricing</div>
            <div class="analysis-content" style="display:grid; gap: 16px;">
                <div class="friend-card">
                    <div class="friend-header">
                        <div class="friend-name">Free</div>
                        <div class="hangout-count">$0</div>
                        </div>
                        <div>• Advanced analytics • Export • Priority support</div>
                </div>
            </div>
          </section> -->

        <!-- Website Footer -->
        <footer class="website-footer">
            <p>&copy; 2025 Friends Energy Tracker. Track your vibes, improve your relationships.</p>
        </footer>
    </div>

<script>
    // env files

    // okay here it comes the import of .env file
// const SUPABASE_URL = window.APP_CONFIG.SUPABASE_URL;
// const SUPABASE_ANON_KEY = window.APP_CONFIG.SUPABASE_ANON_KEY;



    // global variables
let supabaseClient; // will store the supabase client instance for db operations
let currentUser = null; // tracks the currently authenticated user
let selectedEnergy = null; // stores the energy level selected by the user
let isLoading = false; // flag to track if the app is in loading stage

// energy emojis for display 
const energyEmojis = ['', '😤', '😕', '🙂', '😇', '😁'];
const celebrations = ['🎉', '✨', '🌟', '💫', '🎊'];

// INITIALIZATION
// all the code runs only after the html document is parsed and loaded
document.addEventListener('DOMContentLoaded', async () => {
    try {
        // initialize supabase
        if (!window.supabase) {
            throw new Error("Supabase library not loaded");
        }

           // Initialize Supabase
                supabaseClient = window.supabase.createClient(
                    window.APP_CONFIG.SUPABASE_URL, 
                    window.APP_CONFIG.SUPABASE_ANON_KEY
                );

        // supabaseClient = window.supabase.createClient(SUPABASE_URL , SUPABASE_ANON_KEY);

        // set up event listeners here
        setupEventListeners();

        // temporary 
        

        // set up auth listener
        setupAuthListener();

        // check if user is already logged in 
        const {data: {user}} = await supabaseClient.auth.getUser();
        if(user){
            currentUser = user;
            showMainApp();
        }else{
            showAuthModal();
        }
    }catch(error){
        console.error("App initialization error", error);
        showError("Failed to initialize app. Please check your supabase configuration");
    }
});
// summary for DOMcontentLoaded: checks if supabase library is available
// creates supabase client with available url and anonymous key
// setup event listeners with UI operations
// sets up authn event listener
// checks if a user is already logged in and shows appropriate UI
// handles error gracefully


// EVENT LISTENERS SETUP

function setupEventListeners() {
    // google sign in button
    const googleSignIn = document.getElementById('googleSignIn');
    if(googleSignIn){
        googleSignIn.addEventListener('click', signInWithGoogle);
    }

// Add logout button listener here (single event delegation)
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('logout-btn')) {
            logout();
        }
    });

    // energy selector buttons
    document.querySelectorAll('.energy-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.energy-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedEnergy = parseInt(btn.dataset.energy, 10);
        });
    });

    // add hangout button
    const addButton = document.getElementById('addButton');
    if(addButton){
        addButton.addEventListener('click', addHangout);
    }

// summary for setUpEventlisteners : sets up click handler for google signin
// adds clickhandlers for energy selection buttons , removes previous selection , highlights new selection
// sets up handler for a new hangout


// enter key support for friend name input
const friendNameInput = document.getElementById('friendName');
if(friendNameInput){
    friendNameInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') addHangout();
    });
}
}
// allows users to press enter in the friend name input to trigger adding a hangout


// overall till now what this does is 
// initializes a connection to supabase backend services
// sets up authentication using google Oauth
// provides UI for users to : a. sign in with google 
// b. select energy levels usng emoji buttons
// c. add hangout sessions with friends
// 4. handles errors
// 5. keyboad shortcuts for better UX 



// Data storage 
// loads previously stored data from 'friendsDate' if not present returns {}
// let friends = JSON.parse(localStorage.getItem('friendsData') || '{}');
// let selectedEnergy = null;

// PWA install
// let deferredPrompt;

 


// setups and autlistener where the state will change when a user tries to signit
function setupAuthListener() {
    supabaseClient.auth.onAuthStateChange((event , session) => {

        console.log("Auth State changed:", event);
        switch(event) {
            case 'SIGNED_IN':
                if (session) {
                    currentUser = session.user;
                    resetLoadingStates();
                    showMainApp();
                }
                break;

                case 'SIGNED_OUT':
                    currentUser = null;
                    showAuthModal();
                    clearFriendsList();
                    break;

                    case 'TOKEN_REFRESHED':
                        if (session) {
                            currentUser = session.user;
                        }
                        break;
                    }
                });
            }

            async function signInWithGoogle(){
                console.log("google signin clicked");

                if(isLoading){
                    console.log("Already loading , returning"); // debug log
                    return;
                }

                console.log("starting google sign-in process"); // debug log
                isLoading = true;
                updateGoogleButton('Signing in...');
                hideError();

                try {
                console.log("supabase client:", supabaseClient); // debug log

                    const { error } = await supabaseClient.auth.signInWithOAuth({
                        provider: 'google',
                        options: {
                            redirectTo: window.location.origin
                        }
                    });

                    console.log("Oauth response:", {error});

                    if (error) throw error;

                } catch (error) {
                        console.error("Google sign-in-error", error);
                        showError("failed to sign in with Google. Please try again.");
                        resetLoadingStates();
                }
            }

                        async function logout(){
                            console.log("Logout function called!");
                            if(confirm('Are you sure you want to logout?')){
                                console.log("User confirmed logout"); // Add this too
                                try{
                                    await supabaseClient.auth.signOut();

                                }catch(error){
                                    console.error('Sign out error:', error);
                                    showError("failed to sign out. Please try again");
                                }
                            }
                        }
               

            // summary : handles three different levels 
            // signed_in  , signed_out , token_refreshed
            // when a user signs in , the user data is stored , the UI resets , the main app is shown
            // when a user signs out , the user data is removed , and then tweets are temporarily removed from the UI
            // when the token is refreshed  , it updates the current user data


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// UI management functions 

function showAuthModal() {
    const authModal = document.getElementById('authModal');
    const websiteContainer = document.querySelector('.website-container');
    const userInfo = document.querySelector('.user-info');

    if( authModal) authModal.classList.remove('hidden');
    if (websiteContainer) websiteContainer.style.display = 'none';
    if (userInfo) userInfo.classList.remove('visible'); // Hide user info on logout
}

function hideAuthModal(){

    const authModal = document.getElementById('authModal');
    const websiteContainer = document.querySelector('.website-container');

    if (authModal) authModal.classList.add('hidden');
    if (websiteContainer) websiteContainer.style.display = 'block';
}

function showMainApp() {
    hideAuthModal();
    updateUserDisplay();
    loadFriendsData();

    
    // Make user info visible
    const userInfo = document.querySelector('.user-info');
    if (userInfo) {
        userInfo.classList.add('visible'); // Use class instead of inline style
    }


    // // Use event delegation for logout button
    // document.addEventListener('click', function(e) {
    //     if (e.target.classList.contains('logout-btn')) {
    //         logout();
    //     }
    // });
}



function updateUserDisplay() {
    if (!currentUser) return;
    const userEmail = document.getElementById('userEmail');
    const userAvatar = document.getElementById('userAvatar');

    const displayName = currentUser.user_metadata?.full_name || currentUser.email;
    const avatarUrl = currentUser.user_metadata?.avatar_url;

    if (userEmail) userEmail.textContent = displayName;

    if (userAvatar && avatarUrl){
        userAvatar.src = avatarUrl;
        userAvatar.style.display = 'block';
    }
}


    function showError(message) {
        const authError = document.getElementById('authError');
        if (authError) {
            authError.textContent = message;
            authError.classList.remove('hidden');
        }
    }

    function hideError() {
        const authError = document.getElementById('authError');
        if (authError) {
            authError.classList.add('hidden');
        }
    }

    function updateGoogleButton(text) {
        const googleBtnText = document.getElementById('googleBtnText');
        const googleSignIn = document.getElementById('googleSignIn');

        if (googleBtnText) googleBtnText.textContent = text;
        if (googleSignIn) googleSignIn.disabled = isLoading;
    }

    function resetLoadingStates() {
        isLoading = false;
        updateGoogleButton('Sign in with Google');
    }

    function clearFriendsList() {
        const friendsList = document.getElementById('friendsList');
        if (friendsList) {
            friendsList.innerHTML = `
            <div class="empty-state">
                <h3>No friends tracked yet!</h3>
                <p>Add your first hangout above to start analyzing your social energy patterns </p>
                </div>
                `;
        }

        document.getElementById('bestFriendAnalysis')?.classList.add('hidden');
        document.getElementById('dangerAnalysis')?.classList.add('hidden');


        const totalHangouts = document.getElementById('totalHangouts');
        if (totalHangouts) totalHangouts.textContent = '0';
    }


///////////////////////////////////////////////////////////////////////////////////////////////////////
// Database operations

async function addHangout() {
    if (!currentUser) {
        showError('Please sign in to add hangouts.');
        return;
    }

    const friendNameInput = document.getElementById('friendName');
    const friendName = friendNameInput ? friendNameInput.value.trim() : '';


    if(!friendName || selectedEnergy === null){
        //little  shake animation if the data is invalid
        const addBtn = document.getElementById('addButton');
        if(addBtn){
        addBtn.style.animation = 'shake 0.5s ease-in-out';
        setTimeout(() => addBtn.style.animation = '', 500);
        }
        return;
    }

    const addBtn = document.getElementById('addButton');
    if(addBtn) {
        addBtn.disabled = true;
        addBtn.textContent = 'Adding...';
    }

    try {
        const {error} = await supabaseClient
       .from('hangouts')
        .insert({
            user_id: currentUser.id,
            friend_name: friendName,
            energy_level: selectedEnergy,
            hangout_date: new Date().toISOString()
        });

        if(error) throw error;

        // Reset form

        if(friendNameInput) friendNameInput.value = '';
        selectedEnergy = null;
        document.querySelectorAll('.energy-btn').forEach(b => b.classList.remove('selected'));

        // celebrae effect
        celebrate();

        // reload data
        await loadFriendsData();

    }catch(error){
            console.error("Error adding hangout", error);
            showError('Failed to add hangout: ' + error.message);
            
        }finally{
            if(addBtn){
                addBtn.disabled = false;
                addBtn.textContent = 'Add Hangout';
            }
        }
    }

    async function deleteFriend(friendName) {
        if (!currentUser || !confirm(`Are you sure you want to delete all data for ${friendName}?`)) {
            return;
        
    }

    try{
        const {error} = await supabaseClient
       .from('hangouts')
        .delete()
        .eq('user_id', currentUser.id)
        .eq('friend_name', friendName);

        if(error) throw error;

        await loadFriendsData();

    }catch(error){
        console.error("Error deleting friend:", error);
        showError('Failed to delete friend: ',+ error.message);
    }
}

async function loadFriendsData() {
    if(!currentUser) return;

    try{
        const {data: hangouts, error } = await supabaseClient
       .from('hangouts')
        .select('*')
        .eq('user_id', currentUser.id)
        .order('hangout_date', { ascending: false });

        if (error) throw error;
        
        const friends = groupHangoutsByFriend(hangouts);
        renderFriends(friends, hangouts.length);
    
    } catch (error) {
        console.error("Failed to load friends data", error);
        showError('Failed to load your data. Please refresh the page');
    }
    
}

// DATA PROCESSING FUNCTIONS

function groupHangoutsByFriend(hangouts) {
    const friends = {};

    hangouts.forEach(hangout => {
        if(!friends[hangout.friend_name]){
            friends[hangout.friend_name] = {
                hangouts: [],
                energyLevels: []
            };
        }
        friends[hangout.friend_name].hangouts.push(hangout.hangout_date);
        friends[hangout.friend_name].energyLevels.push(hangout.energy_level);

    });

    return friends;
}

// Analysis functions 
    // calculates scores for each friend
    function analyzeWhoToHangoutWith(friends){
        const friendEntries = Object.entries(friends);
        if (friendEntries.length === 0) return '';

        // calculate average energy and frequency for each friend
        // calculating total hangouts and recent hangouts(within 30 days)
        // score formula -> avgEnergy * 2 + recentHangouts
        // return the friend with the highest score
        const analysis = friendEntries.map(([name , data]) => {
            const avgEnergy = data.energyLevels.reduce((a,b) => a+b,0)/data.energyLevels.length;
            const frequency = data.hangouts.length;
            const recentHangouts = data.hangouts.filter(hangout => {
                const hangoutDate = new Date(hangout);
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                return hangoutDate > thirtyDaysAgo;
            }).length;

            return{name , avgEnergy , frequency , recentHangouts , score: avgEnergy*2 + recentHangouts};

        });
    analysis.sort((a,b) => b.score - a.score);
    const best = analysis[0];

    return `${best.name} is your best choice! They have an average energy of ${best.avgEnergy.toFixed(1)} and you've had ${best.recentHangouts} recent hangouts. Their positive energy score is ${best.score.toFixed(1)}.`;
    }

    // analyzing friends who might be emotionally draining you
    // calculating average energy levels and percentage low-energy hangouts
    // flagging the friends with average energy level< 2.5 , total hangouts more than 3 , >60% low energy hangouts
    // warning about the most concerning relationship
    function analyzeDangerousFriends(friends){
        const friendEntries = Object.entries(friends);
        if(friendEntries.length === 0) return '';

        // find friends with consistently low energy
        const dangerousAnalysis = friendEntries.map(([name , data]) => {
            const avgEnergy = data.energyLevels.reduce((a,b) => a + b,0)/data.energyLevels.length;
            const lowEnergyCount = data.energyLevels.filter(energy => energy <= 2).length;
            const lowEnergyPercentage = (lowEnergyCount/data.energyLevels.length) * 100;

            return { name , avgEnergy , lowEnergyPercentage , frequency: data.hangouts.length};

        });
    

    const dangerous = dangerousAnalysis.filter(friend =>
        friend.avgEnergy < 2.5 &&
        friend.lowEnergyPercentage > 60 &&
         friend.frequency >= 3
    );

    if(dangerous.length === 0){
        return 'Great news!  None of your friends show concerning energy patterns.Keep enjoying positive relationships!';
    }

    dangerous.sort((a,b) => a.avgEnergy - b.avgEnergy);
    const mostDangerous = dangerous[0];

    return `${mostDangerous.name} might be draining your energy. Their average energy is ${mostDangerous.avgEnergy.toFixed(1)} and ${mostDangerous.lowEnergyPercentage.toFixed(1)} % of your hangouts were low energy . Consider limiting time with them. `;
}

















// const installPrompt = document.getElementById('installPrompt');

// window.addEventListener('beforeinstallprompt', (e)=>{
//     e.preventDefault();
//     deferredPrompt = e;
//     installPrompt.classList.remove('hidden');
// });

// installPrompt?.addEventListener('click', async() => {
//     if(deferredPrompt){
//         deferredPrompt.prompt();
//         const {outcome} = await deferredPrompt.userChoice;
//         deferredPrompt = null;
//         installPrompt.classList.add('hidden');
//     }
// });
// shows own install UI
// stores the event in deferred prompt


// ////////////////////////////////////


// // Energy selector 
// document.querySelectorAll('.energy-btn').forEach(btn => {
//     btn.addEventListener('click', () => {
//         document.querySelectorAll('.energy-btn').forEach(b => b.classList.remove('selected'));
//         btn.classList.add('selected');
//         selectedEnergy = parseInt(btn.dataset.energy, 10);
//     });
// });
// // adds a clickhandler to energy button
// // clears the previous energy , increases the numeric value of the clicked one



//     if(!friends[name]){
//         friends[name] = {hangouts: [], energyLevels: []};
//     }

//     friends[name].hangouts.push(new Date().toISOString());
//     friends[name].energyLevels.push(selectedEnergy);

//     // Keep only last 20 hangouts
//     if(friends[name].hangouts.length > 50){
//         friends[name].hangouts = friends[name].hangouts.slice(-50);
//         friends[name].energyLevels = friends[name].energyLevels.slice(-50);
//     }

//     localStorage.setItem('friendsData', JSON.stringify(friends));

//     // Reset form  [or ] reset UI
//     nameInput.value = '';
//     selectedEnergy = null;
//     document.querySelectorAll('.energy-btn').forEach(b=>b.classList.remove('selected'));


//     // celebration effect + rerender in the bottom
//     celebrate();
    
//     renderFriends();
// }
// validates input (must have name and an energy picked)
// initialized friend bucket if first time
// adds a timestamp and energy value
// caps the hangouts to 20
// persists to localstorage , resets the form , fires a "celebrate effect" , and re-renders
///////////////////////


// // Add button event listener
// document.getElementById('addButton').addEventListener('click', addHangout);
// // button for add hangout

// // enter key support
// document.getElementById('friendName').addEventListener('keydown', (e) =>{
//     if(e.key === 'Enter') addHangout();
// });

// // Delete friend function
// function deleteFriend(friendName){
//     if(confirm(`Are you sure you want to delete all data for ${friendName}?`)){
//         delete friends[friendName];
//         localStorage.setItem('friendsData', JSON.stringify(friends));
//         renderFriends();
//     }
// }
// This function removes a friend from the system :
// shows a confirmation to prevent accidental deletions
// removes the friend from the friends object and use the delete operator to delete the friend
// update localStorage to persist the change
// call renderfrined to refresh the UI


    
///////////////////////////////////////////////////////////////////////
// Rendering functions

// render friends list
function renderFriends(friends , totalHangouts){
    const friendsList = document.getElementById('friendsList');
    const bestFriendAnalysis = document.getElementById('bestFriendAnalysis');
    const dangerAnalysis = document.getElementById('dangerAnalysis');
    const totalHangoutsEl = document.getElementById('totalHangouts');

    //update total hangouts
    if(totalHangoutsEl) totalHangoutsEl.textContent = totalHangouts;

    if(Object.keys(friends).length === 0){
        clearFriendsList();
        return;
    }

    // show analysis sections 
    const bestFriendContent = document.getElementById('bestFriendContent');
    const dangerContent = document.getElementById('dangerContent');

    if (bestFriendAnalysis && bestFriendContent) {
        bestFriendContent.textContent = analyzeWhoToHangoutWith(friends);
        bestFriendAnalysis.classList.remove('hidden');
    }

    if (dangerAnalysis && dangerContent) {
        dangerContent.textContent = analyzeDangerousFriends(friends);
        dangerAnalysis.classList.remove('hidden');
    }

            // Sort friends by most recent hangout
            const sortedFriends = Object.entries(friends).sort((a, b) => {
                const lastA = new Date(a[1].hangouts[0] || 0);
                const lastB = new Date(b[1].hangouts[0] || 0);
                return lastB - lastA;

            });


            if(friendsList) {
            friendsList.innerHTML = sortedFriends.map(([name, data]) => {
                const avgEnergy = (data.energyLevels.reduce((a,b) => a+b,0)/data.energyLevels.length).toFixed(1);
// sanitized code 
// UI for delete button in 5 and 7th line
                return `
                <div class="friend-card">
                    <div class="friend-header">
                        <div class="friend-name">${name.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}</div>
<div style="display: flex; align-items: center;">
    
                        <div class="hangout-count">${data.hangouts.length} hangouts</div>
                        <button class="delete-btn" onclick="deleteFriend('${name.replace(/'/g, "\\'")}')">Delete</button>
                        </div>
                        </div>
                        <div class="energy-history">
                            ${data.energyLevels.slice(0, 10).map(energy => 
                            `<div class="energy-dot energy-${energy}" title="Energy level ${energy}">${energyEmojis[energy]}</div>`
                            ).join('')}
                        </div>
                        <div class="energy-average energy-${Math.round(avgEnergy)}">
                            Average Energy: ${avgEnergy} ${energyEmojis[Math.round(avgEnergy)]}
                            </div>
                            </div>
                            `;
                            }).join('');
                        }
                    }

               
            // empty state : shows the friendly message and hides the floating stats
            // otherwise sorts friends with the most recent hangout
            // for each friend show these : 1.name 2.name 3.last 10 energy entries 4.average energy rounded and labled

            ///////////////////////////
            // UTILITY FUNCTIONS
        


            // celebratoin effect
            function celebrate() {
                const emoji = celebrations[Math.floor(Math.random() * celebrations.length)];

                const celebEl = document.createElement('div');
                    celebEl.textContent = emoji; // safer than innerHTML
                    celebEl.className = 'celebration';
                    document.body.appendChild(celebEl);
                    setTimeout(() => celebEl.remove(), 2000);
                
            }

            function escapeHtml(text , forAttribute = false){
                const map = {
                    '&' : '&amp;',
                    '<' : '&lt;',
                    '>' : '&gt;',
                    '"' : '&quot;',
                    "'" : '&#39;'

                };

                const escaped = text.replace(/[&<>"']/g, (m) => map[m]);
                return forAttribute ? escaped.replace(/'/g,"\\'"): escaped;

            }

            // // Initialize app
            // renderFriends();

            // service worker registration for offline/PWA features
            // if('serviceWorker' in navigator){
            //     navigator.serviceWorker.register('sw.js');
            // }
// Make deleteFriend globally available
        window.deleteFriend = deleteFriend;
        window.logout = logout;








// summary for the js code:
// single page tracker to track energy levels
// pick an "energy"(1 to 5) to hangout with a friend
// persist it in local storage undr the key friendsData
// render a list of friends with recent energy history + average
// show a little PWA toggle to install the app and confetti style celebration
// register a service worker (sw.js) for offline services and PWA
            </script>









    
    </body>
    
</html>

