CREATE SCHEMA friends_tracker;

CREATE TABLE friends_tracker.hangouts (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  friend_name TEXT NOT NULL,
  energy_level INTEGER NOT NULL CHECK (energy_level >= 1 AND energy_level <= 5),
  hangout_date TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Enable Row Level Security
ALTER TABLE friends_tracker.hangouts ENABLE ROW LEVEL SECURITY;

-- Add RLS policies for security
CREATE POLICY "Users can only see their own hangouts" ON friends_tracker.hangouts
FOR SELECT USING (auth.uid() = user_id);

CREATE POLICY "Users can insert their own hangouts" ON friends_tracker.hangouts
FOR INSERT WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can delete their own hangouts" ON friends_tracker.hangouts
FOR DELETE USING (auth.uid() = user_id);